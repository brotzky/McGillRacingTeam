$(document).ready(function(){function t(t){var e=0;for(var o in t)for(var a in t[o])++e;return e/t.length}function e(t){var e=[];for(prop in t)for(secondProp in t[prop])e.push(t[prop][secondProp]);return e}function o(o){function a(t){t.chart.chartCursor.addListener("changed",n),t.chart.chartCursor.addListener("onHideCursor",r)}function p(t){for(C in charts)charts[C].ignoreZoom&&(charts[C].ignoreZoom=!1),t.chart!=charts[C]&&(charts[C].ignoreZoom=!0,charts[C].zoomToDates(t.startDate,t.endDate))}function n(t){for(var e in charts)t.chart!=charts[e]&&t.position&&(charts[e].chartCursor.isZooming(t.target.zooming),charts[e].chartCursor.selectionPosX=t.target.selectionPosX,charts[e].chartCursor.forceShow=!0,charts[e].chartCursor.setPosition(t.position,!1,t.target.index))}function r(){for(var t in charts)charts[t].chartCursor.hideCursor&&(charts[t].chartCursor.forceShow=!1,charts[t].chartCursor.hideCursor(!1))}var m=t(o),s=e(o),i=[];for(nextProp in o)i.push(Object.keys(o[nextProp]));for(var l=[],c=0;2*m>c;c++)l[c]=[];for(var c=0;c<s.length;c+=m){{s[c].toHHMMSS()}tmp={},tmp[i[0][1]]=s[c+1],tmp[i[0][0]]=s[c].toHHMMSS(),l[0].push(tmp),tmp={},tmp[i[0][2]]=s[c+2],tmp[i[0][0]]=s[c].toHHMMSS(),l[1].push(tmp),tmp={},tmp[i[0][3]]=s[c+3],tmp[i[0][0]]=s[c].toHHMMSS(),l[2].push(tmp),tmp={},tmp[i[0][4]]=s[c+4],tmp[i[0][0]]=s[c].toHHMMSS(),l[3].push(tmp),tmp={},tmp[i[0][5]]=s[c+5],tmp[i[0][0]]=s[c].toHHMMSS(),l[4].push(tmp),tmp={},tmp[i[0][6]]=s[c+6],tmp[i[0][0]]=s[c].toHHMMSS(),l[5].push(tmp),tmp={},tmp[i[0][7]]=s[c+7],tmp[i[0][0]]=s[c].toHHMMSS(),l[6].push(tmp),tmp={},tmp[i[0][8]]=s[c+8],tmp[i[0][0]]=s[c].toHHMMSS(),l[7].push(tmp),tmp={},tmp[i[0][9]]=s[c+9],tmp[i[0][0]]=s[c].toHHMMSS(),l[8].push(tmp),tmp={},tmp[i[0][10]]=s[c+10],tmp[i[0][0]]=s[c].toHHMMSS(),l[9].push(tmp),tmp={},tmp[i[0][11]]=s[c+11],tmp[i[0][0]]=s[c].toHHMMSS(),l[10].push(tmp),tmp={},tmp[i[0][12]]=s[c+12],tmp[i[0][0]]=s[c].toHHMMSS(),l[11].push(tmp),tmp={},tmp[i[0][13]]=s[c+13],tmp[i[0][0]]=s[c].toHHMMSS(),l[12].push(tmp),tmp={},tmp[i[0][14]]=s[c+14],tmp[i[0][0]]=s[c].toHHMMSS(),l[13].push(tmp),tmp={},tmp[i[0][15]]=s[c+15],tmp[i[0][0]]=s[c].toHHMMSS(),l[14].push(tmp),tmp={},tmp[i[0][16]]=s[c+16],tmp[i[0][0]]=s[c].toHHMMSS(),l[15].push(tmp),tmp={},tmp[i[0][17]]=s[c+17],tmp[i[0][0]]=s[c].toHHMMSS(),l[16].push(tmp),tmp={},tmp[i[0][18]]=s[c+18],tmp[i[0][0]]=s[c].toHHMMSS(),l[17].push(tmp),tmp={},tmp[i[0][19]]=s[c+19],tmp[i[0][0]]=s[c].toHHMMSS(),l[18].push(tmp),tmp={},tmp[i[0][20]]=s[c+20],tmp[i[0][0]]=s[c].toHHMMSS(),l[19].push(tmp),tmp={},tmp[i[0][21]]=s[c+21],tmp[i[0][0]]=s[c].toHHMMSS(),l[20].push(tmp),tmp={},tmp[i[0][22]]=s[c+22],tmp[i[0][0]]=s[c].toHHMMSS(),l[21].push(tmp),tmp={},tmp[i[0][23]]=s[c+23],tmp[i[0][0]]=s[c].toHHMMSS(),l[22].push(tmp),tmp={},tmp[i[0][24]]=s[c+24],tmp[i[0][0]]=s[c].toHHMMSS(),l[23].push(tmp),tmp={},tmp[i[0][25]]=s[c+25],tmp[i[0][0]]=s[c].toHHMMSS(),l[24].push(tmp),tmp={},tmp[i[0][26]]=s[c+26],tmp[i[0][0]]=s[c].toHHMMSS(),l[25].push(tmp),tmp={},tmp[i[0][25]]=s[c+25],tmp[i[0][0]]=s[c].toHHMMSS(),l[26].push(tmp),tmp={},tmp[i[0][27]]=s[c+27],tmp[i[0][0]]=s[c].toHHMMSS(),l[26].push(tmp),tmp={},tmp[i[0][28]]=s[c+28],tmp[i[0][0]]=s[c].toHHMMSS(),l[27].push(tmp),tmp={},tmp[i[0][29]]=s[c+29],tmp[i[0][0]]=s[c].toHHMMSS(),l[28].push(tmp),tmp={},tmp[i[0][30]]=s[c+30],tmp[i[0][0]]=s[c].toHHMMSS(),l[29].push(tmp),tmp={},tmp[i[0][31]]=s[c+31],tmp[i[0][0]]=s[c].toHHMMSS(),l[30].push(tmp),tmp={},tmp[i[0][32]]=s[c+32],tmp[i[0][0]]=s[c].toHHMMSS(),l[31].push(tmp),tmp={},tmp[i[0][33]]=s[c+33],tmp[i[0][0]]=s[c].toHHMMSS(),l[32].push(tmp),tmp={},tmp[i[0][34]]=s[c+34],tmp[i[0][0]]=s[c].toHHMMSS(),l[33].push(tmp),tmp={},tmp[i[0][35]]=s[c+35],tmp[i[0][0]]=s[c].toHHMMSS(),l[34].push(tmp),tmp={},tmp[i[0][36]]=s[c+36],tmp[i[0][0]]=s[c].toHHMMSS(),l[35].push(tmp),tmp={},tmp[i[0][37]]=s[c+37],tmp[i[0][0]]=s[c].toHHMMSS(),l[26].push(tmp),tmp={},tmp[i[0][38]]=s[c+38],tmp[i[0][0]]=s[c].toHHMMSS(),l[37].push(tmp),tmp={},tmp[i[0][39]]=s[c+39],tmp[i[0][0]]=s[c].toHHMMSS(),l[38].push(tmp),tmp={},tmp[i[0][40]]=s[c+40],tmp[i[0][0]]=s[c].toHHMMSS(),l[39].push(tmp),tmp={},tmp[i[0][41]]=s[c+41],tmp[i[0][0]]=s[c].toHHMMSS(),l[40].push(tmp),tmp={},tmp[i[0][42]]=s[c+42],tmp[i[0][0]]=s[c].toHHMMSS(),l[41].push(tmp)}for(var u=["#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5","#7CB342","#00BCD4","#455A64","#1565C0","#4CAF50","#990000","#283593","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5"],d=document.getElementById("sideList"),h=[],c=0;c<i[0].length-1;c++)h[c]=[];for(charts=[],c=0;c<i[0].length-1;c++){var M=document.createElement("div"),S=document.createElement("li"),f=document.createElement("a"),H=document.createElement("h2"),v=document.createElement("span");$("#amchartContainer").length||(M.id="amchartContainer",document.getElementsByTagName("body")[0].appendChild(M)),v.id=i[0][c+1],M=document.getElementById("amchartContainer"),H.innerHTML=i[0][c+1],temp=document.createElement("div"),temp.id="chartdiv"+[c],f.href="#"+i[0][c+1],f.innerHTML=i[0][c+1],S.appendChild(f),S.innerHTML="<a href='#"+i[0][c+1]+"'>"+i[0][c+1]+" </a>",M.appendChild(H),M.appendChild(temp),d.appendChild(S),H.appendChild(v);var g=temp.id.toString();h[c]={type:"serial",theme:"dark",dataDateFormat:"HH:NN:SS",marginRight:50,autoMarginOffset:50,dataProvider:l[c],responsive:{enabled:!0},balloon:{cornerRadius:0},valueAxes:[{axisAlpha:0}],graphs:[{balloonText:"[[lapTimeOfDay]]<br><b><span style='font-size:14px;'>[[value]]</span></b>",bullet:"round",bulletSize:6,connect:!1,gapPeriod:200,lineColor:u[c],lineThickness:1,negativeLineColor:"#487dac",valueField:i[0][c+1].toString()}],chartCursor:{categoryBalloonDateFormat:"HH:NN:SS",cursorAlpha:.1,cursorColor:u[c],fullWidth:!0,graphBulletSize:2},chartScrollbar:{},categoryField:"lapTimeOfDay",categoryAxis:{minPeriod:"ss",parseDates:!0,minorGridEnabled:!0},"export":{enabled:!0}},charts.push(AmCharts.makeChart(g,h[c]))}for(var C in charts)charts[C].addListener("zoomed",p),charts[C].addListener("init",a)}function a(){$(".moreInfo").toggleClass("showMoreInfo"),"More"===$(this).text()?(u.innerHTML="Less",u.style.paddingLeft="19px"):(u.innerHTML="More",u.style.paddingLeft="16px")}function p(t){var o=new Firebase("https://torrid-fire-7257.firebaseio.com/"+t);o.on("value",function(t){snapshotObj=t.val();for(var o=e(snapshotObj),a=[],p=0;p<o.length;p++)a[p]=document.createElement("li");for(var n=(document.getElementById("commentList"),$("#commentList")),p=0;p<o.length;p++)a[p]="<li>"+o[p]+"</li>",n.append(a[p])},function(t){console.log("The read failed: "+t.code)})}function n(){r.unauth();var t=r.getAuth();t||(window.location="/mrt/")}var r=new Firebase("//torrid-fire-7257.firebaseio.com");if(-1===window.location.href.indexOf("data"))""===document.forms.login.email.value&&document.forms.login.email.focus(),$(".login-container").addClass("login-container-active"),$("#login-form").keyup(function(t){t.preventDefault();var e=$(".userName").val().toString(),o=$(".userPass").val().toString();r.authWithPassword({email:e,password:o},function(t){t||($(".login-container").fadeOut("fast"),setTimeout(function(){window.location="mrt/data"},400))})}),$("#login-form").on("submit",function(t){t.preventDefault();var e=$(".userName").val().toString(),o=$(".userPass").val().toString();r.authWithPassword({email:e,password:o,async:!0},function(t){t?($("input[class*='user']").addClass("invalidLogin"),$(".loginError").fadeIn()):($(".login-container").removeClass("login-container-active"),$(".login-container").fadeOut("slow"),setTimeout(function(){window.location="mrt/data"},444))})});else{$("nav").addClass("onload-reveal");var m=$(".uploadMessage"),s=$(".toBeUploaded"),i=$(".aside-comments");String.prototype.toHHMMSS=function(){var t=parseInt(this,10),e=Math.floor(t/3600),o=Math.floor((t-3600*e)/60),a=t-3600*e-60*o;10>e&&(e="0"+e),10>o&&(o="0"+o),10>a&&(a="0"+a);var p=e+":"+o+":"+a;return p};var l=$(".selectInput > option:first-child").val(),c=l.substr(l.lastIndexOf("/")+1).split(".").shift();p(c);var u=document.querySelector(".moreButton");u.addEventListener("click",a,!1),$(".hideLoading").show(),$.getJSON(l,function(t){o(t),$(".aside-default").addClass("aside-active"),$(".hideLoading").fadeOut(333)}),$(".postComments").submit(function(t){t.preventDefault();var e=$(".selectInput").val(),o=e.substr(e.lastIndexOf("/")+1),a=o.split("."),p=a.shift(),n=$(".addComment").val();$(".addComment").val("");var m=doucment.getElementById("commentList");m.children().length>1&&m.children().remove();var s=r.child(p);s.push({comment:n})}),$(".selectInput").change(function(){var t=$(this).val();$(".hideLoading").show(),$("aside").removeClass("aside-active"),$("#amchartContainer").children().length>1&&($("#amchartContainer").fadeOut(300),setTimeout(function(){$("#amchartContainer").remove(),$("#sideList").children().remove()},300)),setTimeout(function(){p(c),$.getJSON(t,function(t){o(t),$(".aside-default").addClass("aside-active"),$(".hideLoading").fadeOut(333)})},505)}),$(".toggleComments").click(function(){i.toggleClass("aside-active")}),$(document).keyup(function(t){if(27==t.keyCode){i.removeClass("aside-active"),$(".moreInfo").removeClass("showMoreInfo");var e=document.querySelector(".moreButton");"More"===$(".moreButton").text()?(e.innerHTML="Less",e.style.paddingLeft="19px"):(e.innerHTML="More",e.style.paddingLeft="16px")}}),$(document).scrollScope();var d=document.querySelector(".logoutButton");d.addEventListener("click",n,!1),$("#fileToUpload").change(function(){s.val().length>30?($(".uploadMessage > p").text("Sorry, file name must be less than 30 characeters"),m.addClass("uploadMessage-active").delay(5e3).queue(function(t){$(this).removeClass("uploadMessage-active"),t()})):(s.val($(this).val().split("\\").pop()),$(".confirmUpload").addClass("confirmUpload-active"))}),$(".uploadForm").submit(function(t){t.preventDefault();var e="/mrt/csvUploader.php",o=new FormData(this),a=$("#fileToUpload").val().split("\\").pop().split(".").shift();return $(".confirmUpload").removeClass("confirmUpload-active"),m.css("background-color","#D32F2F"),$.ajax({type:"POST",url:e,data:o,processData:!1,contentType:!1,success:function(t){if($(".uploadMessage > p").text(t),m.addClass("uploadMessage-active").delay(4800).queue(function(t){$(this).removeClass("uploadMessage-active"),t()}),t.indexOf("succesfully")>-1){$(".uploadMessage").css("background-color","#388E3C");var e=document.createElement("option");fileNameReplaced=a.replace(/_/g," "),e.innerHTML=fileNameReplaced,e.value="/mrt/inputdata/"+a+".json",$(".selectInput").prepend(e)}}}),!1})}});