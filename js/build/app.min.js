$(document).ready(function(){function t(){$(".aside-default").addClass("aside-active"),$(".hideLoading").fadeOut(333)}function e(t){var e=0;for(var o in t)for(var p in t[o])++e;return e/t.length}function o(t){var e=[];for(prop in t)for(secondProp in t[prop])e.push(t[prop][secondProp]);return e}function p(t){function p(t){t.chart.chartCursor.addListener("changed",r),t.chart.chartCursor.addListener("onHideCursor",m)}function a(t){for(C in charts)charts[C].ignoreZoom&&(charts[C].ignoreZoom=!1),t.chart!=charts[C]&&(charts[C].ignoreZoom=!0,charts[C].zoomToDates(t.startDate,t.endDate))}function r(t){for(var e in charts)t.chart!=charts[e]&&t.position&&(charts[e].chartCursor.isZooming(t.target.zooming),charts[e].chartCursor.selectionPosX=t.target.selectionPosX,charts[e].chartCursor.forceShow=!0,charts[e].chartCursor.setPosition(t.position,!1,t.target.index))}function m(){for(var t in charts)charts[t].chartCursor.hideCursor&&(charts[t].chartCursor.forceShow=!1,charts[t].chartCursor.hideCursor(!1))}var n=e(t),s=o(t),i=[];for(nextProp in t)i.push(Object.keys(t[nextProp]));for(var c=[],u=0;2*n>u;u++)c[u]=[];for(var u=0;u<s.length;u+=n){{s[u].toHHMMSS()}tmp={},tmp[i[0][1]]=s[u+1],tmp[i[0][0]]=s[u].toHHMMSS(),c[0].push(tmp),tmp={},tmp[i[0][2]]=s[u+2],tmp[i[0][0]]=s[u].toHHMMSS(),c[1].push(tmp),tmp={},tmp[i[0][3]]=s[u+3],tmp[i[0][0]]=s[u].toHHMMSS(),c[2].push(tmp),tmp={},tmp[i[0][4]]=s[u+4],tmp[i[0][0]]=s[u].toHHMMSS(),c[3].push(tmp),tmp={},tmp[i[0][5]]=s[u+5],tmp[i[0][0]]=s[u].toHHMMSS(),c[4].push(tmp),tmp={},tmp[i[0][6]]=s[u+6],tmp[i[0][0]]=s[u].toHHMMSS(),c[5].push(tmp),tmp={},tmp[i[0][7]]=s[u+7],tmp[i[0][0]]=s[u].toHHMMSS(),c[6].push(tmp),tmp={},tmp[i[0][8]]=s[u+8],tmp[i[0][0]]=s[u].toHHMMSS(),c[7].push(tmp),tmp={},tmp[i[0][9]]=s[u+9],tmp[i[0][0]]=s[u].toHHMMSS(),c[8].push(tmp),tmp={},tmp[i[0][10]]=s[u+10],tmp[i[0][0]]=s[u].toHHMMSS(),c[9].push(tmp),tmp={},tmp[i[0][11]]=s[u+11],tmp[i[0][0]]=s[u].toHHMMSS(),c[10].push(tmp),tmp={},tmp[i[0][12]]=s[u+12],tmp[i[0][0]]=s[u].toHHMMSS(),c[11].push(tmp),tmp={},tmp[i[0][13]]=s[u+13],tmp[i[0][0]]=s[u].toHHMMSS(),c[12].push(tmp),tmp={},tmp[i[0][14]]=s[u+14],tmp[i[0][0]]=s[u].toHHMMSS(),c[13].push(tmp),tmp={},tmp[i[0][15]]=s[u+15],tmp[i[0][0]]=s[u].toHHMMSS(),c[14].push(tmp),tmp={},tmp[i[0][16]]=s[u+16],tmp[i[0][0]]=s[u].toHHMMSS(),c[15].push(tmp),tmp={},tmp[i[0][17]]=s[u+17],tmp[i[0][0]]=s[u].toHHMMSS(),c[16].push(tmp),tmp={},tmp[i[0][18]]=s[u+18],tmp[i[0][0]]=s[u].toHHMMSS(),c[17].push(tmp),tmp={},tmp[i[0][19]]=s[u+19],tmp[i[0][0]]=s[u].toHHMMSS(),c[18].push(tmp),tmp={},tmp[i[0][20]]=s[u+20],tmp[i[0][0]]=s[u].toHHMMSS(),c[19].push(tmp),tmp={},tmp[i[0][21]]=s[u+21],tmp[i[0][0]]=s[u].toHHMMSS(),c[20].push(tmp),tmp={},tmp[i[0][22]]=s[u+22],tmp[i[0][0]]=s[u].toHHMMSS(),c[21].push(tmp),tmp={},tmp[i[0][23]]=s[u+23],tmp[i[0][0]]=s[u].toHHMMSS(),c[22].push(tmp),tmp={},tmp[i[0][24]]=s[u+24],tmp[i[0][0]]=s[u].toHHMMSS(),c[23].push(tmp),tmp={},tmp[i[0][25]]=s[u+25],tmp[i[0][0]]=s[u].toHHMMSS(),c[24].push(tmp),tmp={},tmp[i[0][26]]=s[u+26],tmp[i[0][0]]=s[u].toHHMMSS(),c[25].push(tmp),tmp={},tmp[i[0][25]]=s[u+25],tmp[i[0][0]]=s[u].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][27]]=s[u+27],tmp[i[0][0]]=s[u].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][28]]=s[u+28],tmp[i[0][0]]=s[u].toHHMMSS(),c[27].push(tmp),tmp={},tmp[i[0][29]]=s[u+29],tmp[i[0][0]]=s[u].toHHMMSS(),c[28].push(tmp),tmp={},tmp[i[0][30]]=s[u+30],tmp[i[0][0]]=s[u].toHHMMSS(),c[29].push(tmp),tmp={},tmp[i[0][31]]=s[u+31],tmp[i[0][0]]=s[u].toHHMMSS(),c[30].push(tmp),tmp={},tmp[i[0][32]]=s[u+32],tmp[i[0][0]]=s[u].toHHMMSS(),c[31].push(tmp),tmp={},tmp[i[0][33]]=s[u+33],tmp[i[0][0]]=s[u].toHHMMSS(),c[32].push(tmp),tmp={},tmp[i[0][34]]=s[u+34],tmp[i[0][0]]=s[u].toHHMMSS(),c[33].push(tmp),tmp={},tmp[i[0][35]]=s[u+35],tmp[i[0][0]]=s[u].toHHMMSS(),c[34].push(tmp),tmp={},tmp[i[0][36]]=s[u+36],tmp[i[0][0]]=s[u].toHHMMSS(),c[35].push(tmp),tmp={},tmp[i[0][37]]=s[u+37],tmp[i[0][0]]=s[u].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][38]]=s[u+38],tmp[i[0][0]]=s[u].toHHMMSS(),c[37].push(tmp),tmp={},tmp[i[0][39]]=s[u+39],tmp[i[0][0]]=s[u].toHHMMSS(),c[38].push(tmp),tmp={},tmp[i[0][40]]=s[u+40],tmp[i[0][0]]=s[u].toHHMMSS(),c[39].push(tmp),tmp={},tmp[i[0][41]]=s[u+41],tmp[i[0][0]]=s[u].toHHMMSS(),c[40].push(tmp),tmp={},tmp[i[0][42]]=s[u+42],tmp[i[0][0]]=s[u].toHHMMSS(),c[41].push(tmp)}for(var l=["#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5","#7CB342","#00BCD4","#455A64","#1565C0","#4CAF50","#990000","#283593","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5"],d=document.getElementById("sideList"),h=[],u=0;u<i[0].length-1;u++)h[u]=[];for(charts=[],u=0;u<i[0].length-1;u++){var M=document.createElement("div"),S=document.createElement("li"),H=document.createElement("a"),f=document.createElement("h2"),v=document.createElement("span");$("#amchartContainer").length||(M.id="amchartContainer",document.getElementsByTagName("body")[0].appendChild(M)),v.id=i[0][u+1],M=document.getElementById("amchartContainer"),f.innerHTML=i[0][u+1],temp=document.createElement("div"),temp.id="chartdiv"+[u],H.href="#"+i[0][u+1],H.innerHTML=i[0][u+1],S.appendChild(H),S.innerHTML="<a href='#"+i[0][u+1]+"'>"+i[0][u+1]+" </a>",M.appendChild(f),M.appendChild(temp),d.appendChild(S),f.appendChild(v);var g=temp.id.toString();h[u]={type:"serial",theme:"dark",dataDateFormat:"HH:NN:SS",marginRight:50,autoMarginOffset:50,dataProvider:c[u],responsive:{enabled:!0},balloon:{cornerRadius:0},valueAxes:[{axisAlpha:0}],graphs:[{balloonText:"[[lapTimeOfDay]]<br><b><span style='font-size:14px;'>[[value]]</span></b>",bullet:"round",bulletSize:6,connect:!1,gapPeriod:200,lineColor:l[u],lineThickness:1,negativeLineColor:"#487dac",valueField:i[0][u+1].toString()}],chartCursor:{categoryBalloonDateFormat:"HH:NN:SS",cursorAlpha:.1,cursorColor:l[u],fullWidth:!0,graphBulletSize:2},chartScrollbar:{},categoryField:"lapTimeOfDay",categoryAxis:{minPeriod:"ss",parseDates:!0,minorGridEnabled:!0},"export":{enabled:!0}},charts.push(AmCharts.makeChart(g,h[u]))}for(var C in charts)charts[C].addListener("zoomed",a),charts[C].addListener("init",p)}function a(){$(".moreInfo").toggleClass("showMoreInfo"),"More"===$(this).text()?(h.innerHTML="Less",h.style.paddingLeft="19px"):(h.innerHTML="More",h.style.paddingLeft="16px")}function r(){var t=new Firebase("//torrid-fire-7257.firebaseio.com/"+s());t.on("value",function(t){snapshotObj=t.val();for(var e=o(snapshotObj),p=[],a=0;a<e.length;a++)p[a]=document.createElement("li");for(var r=(document.getElementById("commentList"),$("#commentList")),a=0;a<e.length;a++)p[a]="<li>"+e[a]+"</li>",r.append(p[a])},function(t){console.log("The read failed: "+t.code)})}function m(){var t=$("#commentList");t.children().length>1&&($("#amchartContainer").fadeOut(300),t.children().remove())}function n(){return $(".selectInput").val()}function s(){return n().substr(n().lastIndexOf("/")+1).split(".").shift()}function i(){c.unauth();var t=c.getAuth();t||(window.location="/mrt/")}var c=new Firebase("//torrid-fire-7257.firebaseio.com"),u=$(".uploadMessage"),l=$(".toBeUploaded"),d=$(".aside-comments");!function(){document.getElementById("topNav").className+="onload-reveal";var e=$(".selectInput > option:first-child").val();$(".hideLoading").show(),$.getJSON(e,function(e){p(e),r(),t()})}(),$(".selectInput").change(function(){var e=$("#amchartContainer");$(".hideLoading").show(),$("aside").removeClass("aside-active"),e.children().length>1&&(e.fadeOut(300),setTimeout(function(){e.remove(),$("#sideList").children().remove()},300)),m(),setTimeout(function(){$.getJSON(n(),function(e){p(e),t(),r()})},525)}),String.prototype.toHHMMSS=function(){var t=parseInt(this,10),e=Math.floor(t/3600),o=Math.floor((t-3600*e)/60),p=t-3600*e-60*o;10>e&&(e="0"+e),10>o&&(o="0"+o),10>p&&(p="0"+p);var a=e+":"+o+":"+p;return a};var h=document.querySelector(".moreButton");h.addEventListener("click",a,!1),$(".postComments").submit(function(t){t.preventDefault();var e=$(".addComment").val(),o=$("#commentList");o.children().length>1&&o.children().remove();var p=c.child(s());p.push({comment:e})}),$(".toggleComments").click(function(){d.toggleClass("aside-active")}),$(document).keyup(function(t){if(27==t.keyCode){d.removeClass("aside-active"),$(".moreInfo").removeClass("showMoreInfo");var e=document.querySelector(".moreButton");"More"===$(".moreButton").text()?(e.innerHTML="Less",e.style.paddingLeft="19px"):(e.innerHTML="More",e.style.paddingLeft="16px")}}),$(document).scrollScope();var M=document.querySelector(".logoutButton");M.addEventListener("click",i,!1),$("#fileToUpload").change(function(){l.val().length>30?($(".uploadMessage > p").text("Sorry, file name must be less than 30 characeters"),u.addClass("uploadMessage-active").delay(5e3).queue(function(t){$(this).removeClass("uploadMessage-active"),t()})):(l.val($(this).val().split("\\").pop()),$(".confirmUpload").addClass("confirmUpload-active"))}),$(".uploadForm").submit(function(t){t.preventDefault();var e="/mrt/csvUploader.php",o=new FormData(this),p=$("#fileToUpload").val().split("\\").pop().split(".").shift();return $(".confirmUpload").removeClass("confirmUpload-active"),u.css("background-color","#D32F2F"),$.ajax({type:"POST",url:e,data:o,processData:!1,contentType:!1,success:function(t){if($(".uploadMessage > p").text(t),u.addClass("uploadMessage-active").delay(4800).queue(function(t){$(this).removeClass("uploadMessage-active"),t()}),t.indexOf("succesfully")>-1){$(".uploadMessage").css("background-color","#388E3C");var e=document.createElement("option");fileNameReplaced=p.replace(/_/g," "),e.innerHTML=fileNameReplaced,e.value="/mrt/inputdata/"+p+".json",$(".selectInput").prepend(e)}}}),!1})});