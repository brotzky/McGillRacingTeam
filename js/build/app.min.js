$(document).ready(function(){function t(){$(".aside-default").addClass("aside-active"),$(".hideLoading").fadeOut(333)}function e(t){var e=0;for(var o in t)for(var p in t[o])++e;return e/t.length}function o(t){var e=[];for(prop in t)for(secondProp in t[prop])e.push(t[prop][secondProp]);return e}function p(t){function p(t){t.chart.chartCursor.addListener("changed",r),t.chart.chartCursor.addListener("onHideCursor",n)}function a(t){for(C in charts)charts[C].ignoreZoom&&(charts[C].ignoreZoom=!1),t.chart!=charts[C]&&(charts[C].ignoreZoom=!0,charts[C].zoomToDates(t.startDate,t.endDate))}function r(t){for(var e in charts)t.chart!=charts[e]&&t.position&&(charts[e].chartCursor.isZooming(t.target.zooming),charts[e].chartCursor.selectionPosX=t.target.selectionPosX,charts[e].chartCursor.forceShow=!0,charts[e].chartCursor.setPosition(t.position,!1,t.target.index))}function n(){for(var t in charts)charts[t].chartCursor.hideCursor&&(charts[t].chartCursor.forceShow=!1,charts[t].chartCursor.hideCursor(!1))}var m=e(t),s=o(t),i=[];for(nextProp in t)i.push(Object.keys(t[nextProp]));for(var c=[],l=0;2*m>l;l++)c[l]=[];for(var l=0;l<s.length;l+=m){{s[l].toHHMMSS()}tmp={},tmp[i[0][1]]=s[l+1],tmp[i[0][0]]=s[l].toHHMMSS(),c[0].push(tmp),tmp={},tmp[i[0][2]]=s[l+2],tmp[i[0][0]]=s[l].toHHMMSS(),c[1].push(tmp),tmp={},tmp[i[0][3]]=s[l+3],tmp[i[0][0]]=s[l].toHHMMSS(),c[2].push(tmp),tmp={},tmp[i[0][4]]=s[l+4],tmp[i[0][0]]=s[l].toHHMMSS(),c[3].push(tmp),tmp={},tmp[i[0][5]]=s[l+5],tmp[i[0][0]]=s[l].toHHMMSS(),c[4].push(tmp),tmp={},tmp[i[0][6]]=s[l+6],tmp[i[0][0]]=s[l].toHHMMSS(),c[5].push(tmp),tmp={},tmp[i[0][7]]=s[l+7],tmp[i[0][0]]=s[l].toHHMMSS(),c[6].push(tmp),tmp={},tmp[i[0][8]]=s[l+8],tmp[i[0][0]]=s[l].toHHMMSS(),c[7].push(tmp),tmp={},tmp[i[0][9]]=s[l+9],tmp[i[0][0]]=s[l].toHHMMSS(),c[8].push(tmp),tmp={},tmp[i[0][10]]=s[l+10],tmp[i[0][0]]=s[l].toHHMMSS(),c[9].push(tmp),tmp={},tmp[i[0][11]]=s[l+11],tmp[i[0][0]]=s[l].toHHMMSS(),c[10].push(tmp),tmp={},tmp[i[0][12]]=s[l+12],tmp[i[0][0]]=s[l].toHHMMSS(),c[11].push(tmp),tmp={},tmp[i[0][13]]=s[l+13],tmp[i[0][0]]=s[l].toHHMMSS(),c[12].push(tmp),tmp={},tmp[i[0][14]]=s[l+14],tmp[i[0][0]]=s[l].toHHMMSS(),c[13].push(tmp),tmp={},tmp[i[0][15]]=s[l+15],tmp[i[0][0]]=s[l].toHHMMSS(),c[14].push(tmp),tmp={},tmp[i[0][16]]=s[l+16],tmp[i[0][0]]=s[l].toHHMMSS(),c[15].push(tmp),tmp={},tmp[i[0][17]]=s[l+17],tmp[i[0][0]]=s[l].toHHMMSS(),c[16].push(tmp),tmp={},tmp[i[0][18]]=s[l+18],tmp[i[0][0]]=s[l].toHHMMSS(),c[17].push(tmp),tmp={},tmp[i[0][19]]=s[l+19],tmp[i[0][0]]=s[l].toHHMMSS(),c[18].push(tmp),tmp={},tmp[i[0][20]]=s[l+20],tmp[i[0][0]]=s[l].toHHMMSS(),c[19].push(tmp),tmp={},tmp[i[0][21]]=s[l+21],tmp[i[0][0]]=s[l].toHHMMSS(),c[20].push(tmp),tmp={},tmp[i[0][22]]=s[l+22],tmp[i[0][0]]=s[l].toHHMMSS(),c[21].push(tmp),tmp={},tmp[i[0][23]]=s[l+23],tmp[i[0][0]]=s[l].toHHMMSS(),c[22].push(tmp),tmp={},tmp[i[0][24]]=s[l+24],tmp[i[0][0]]=s[l].toHHMMSS(),c[23].push(tmp),tmp={},tmp[i[0][25]]=s[l+25],tmp[i[0][0]]=s[l].toHHMMSS(),c[24].push(tmp),tmp={},tmp[i[0][26]]=s[l+26],tmp[i[0][0]]=s[l].toHHMMSS(),c[25].push(tmp),tmp={},tmp[i[0][25]]=s[l+25],tmp[i[0][0]]=s[l].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][27]]=s[l+27],tmp[i[0][0]]=s[l].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][28]]=s[l+28],tmp[i[0][0]]=s[l].toHHMMSS(),c[27].push(tmp),tmp={},tmp[i[0][29]]=s[l+29],tmp[i[0][0]]=s[l].toHHMMSS(),c[28].push(tmp),tmp={},tmp[i[0][30]]=s[l+30],tmp[i[0][0]]=s[l].toHHMMSS(),c[29].push(tmp),tmp={},tmp[i[0][31]]=s[l+31],tmp[i[0][0]]=s[l].toHHMMSS(),c[30].push(tmp),tmp={},tmp[i[0][32]]=s[l+32],tmp[i[0][0]]=s[l].toHHMMSS(),c[31].push(tmp),tmp={},tmp[i[0][33]]=s[l+33],tmp[i[0][0]]=s[l].toHHMMSS(),c[32].push(tmp),tmp={},tmp[i[0][34]]=s[l+34],tmp[i[0][0]]=s[l].toHHMMSS(),c[33].push(tmp),tmp={},tmp[i[0][35]]=s[l+35],tmp[i[0][0]]=s[l].toHHMMSS(),c[34].push(tmp),tmp={},tmp[i[0][36]]=s[l+36],tmp[i[0][0]]=s[l].toHHMMSS(),c[35].push(tmp),tmp={},tmp[i[0][37]]=s[l+37],tmp[i[0][0]]=s[l].toHHMMSS(),c[26].push(tmp),tmp={},tmp[i[0][38]]=s[l+38],tmp[i[0][0]]=s[l].toHHMMSS(),c[37].push(tmp),tmp={},tmp[i[0][39]]=s[l+39],tmp[i[0][0]]=s[l].toHHMMSS(),c[38].push(tmp),tmp={},tmp[i[0][40]]=s[l+40],tmp[i[0][0]]=s[l].toHHMMSS(),c[39].push(tmp),tmp={},tmp[i[0][41]]=s[l+41],tmp[i[0][0]]=s[l].toHHMMSS(),c[40].push(tmp),tmp={},tmp[i[0][42]]=s[l+42],tmp[i[0][0]]=s[l].toHHMMSS(),c[41].push(tmp)}for(var u=["#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5","#7CB342","#00BCD4","#455A64","#1565C0","#4CAF50","#990000","#283593","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#ed5153","#323a45","#3F51B5","#009688","#BF360C","#4CAF50","#FF9800","#FF5722","#607D8B","#673AB7","#D32F2F","#880E4F","#283593","#004D40","#01579B","#4CAF50","#FBC02D","#424242","#3F51B5"],d=document.getElementById("sideList"),h=[],l=0;l<i[0].length-1;l++)h[l]=[];for(charts=[],l=0;l<i[0].length-1;l++){var M=document.createElement("div"),S=document.createElement("li"),H=document.createElement("a"),f=document.createElement("h2"),v=document.createElement("span");$("#amchartContainer").length||(M.id="amchartContainer",document.getElementsByTagName("body")[0].appendChild(M)),v.id=i[0][l+1],M=document.getElementById("amchartContainer"),f.innerHTML=i[0][l+1],temp=document.createElement("div"),temp.id="chartdiv"+[l],H.href="#"+i[0][l+1],H.innerHTML=i[0][l+1],S.appendChild(H),S.innerHTML="<a href='#"+i[0][l+1]+"'>"+i[0][l+1]+" </a>",M.appendChild(f),M.appendChild(temp),d.appendChild(S),f.appendChild(v);var g=temp.id.toString();h[l]={type:"serial",theme:"dark",dataDateFormat:"HH:NN:SS",marginRight:50,autoMarginOffset:50,dataProvider:c[l],responsive:{enabled:!0},balloon:{cornerRadius:0},valueAxes:[{axisAlpha:0}],graphs:[{balloonText:"[[lapTimeOfDay]]<br><b><span style='font-size:14px;'>[[value]]</span></b>",bullet:"round",bulletSize:6,connect:!1,gapPeriod:200,lineColor:u[l],lineThickness:1,negativeLineColor:"#487dac",valueField:i[0][l+1].toString()}],chartCursor:{categoryBalloonDateFormat:"HH:NN:SS",cursorAlpha:.1,cursorColor:u[l],fullWidth:!0,graphBulletSize:2},chartScrollbar:{},categoryField:"lapTimeOfDay",categoryAxis:{minPeriod:"ss",parseDates:!0,minorGridEnabled:!0},"export":{enabled:!0}},charts.push(AmCharts.makeChart(g,h[l]))}for(var C in charts)charts[C].addListener("zoomed",a),charts[C].addListener("init",p)}function a(){$(".moreInfo").toggleClass("showMoreInfo"),"More"===$(this).text()?(h.innerHTML="Less",h.style.paddingLeft="19px"):(h.innerHTML="More",h.style.paddingLeft="16px")}function r(){var t=new Firebase("//torrid-fire-7257.firebaseio.com/"+s());t.on("value",function(t){snapshotObj=t.val();for(var e=o(snapshotObj),p=[],a=0;a<e.length;a++)p[a]=document.createElement("li");for(var r=(document.getElementById("commentList"),$("#commentList")),a=0;a<e.length;a++)p[a]="<li>"+e[a]+"</li>",r.append(p[a])},function(t){console.log("The read failed: "+t.code)})}function n(){var t=$("#commentList");t.children().length>1&&($("#amchartContainer").fadeOut(300),t.children().remove())}function m(){return $(".selectInput").val()}function s(){return m().substr(m().lastIndexOf("/")+1).split(".").shift()}function i(){c.unauth();var t=c.getAuth();t||(window.location="/mrt/")}var c=new Firebase("//torrid-fire-7257.firebaseio.com"),l=$(".uploadMessage"),u=$(".toBeUploaded"),d=$(".aside-comments");!function(){document.getElementById("topNav").className+="onload-reveal";var e=$(".selectInput > option:first-child").val();$(".hideLoading").show(),-1===e.indexOf("csv")?$.getJSON(e,function(e){p(e),r(),t()}):Papa.parse(e,{download:!0,header:!0,skipEmptyLines:!0,complete:function(e){console.log(e.data),p(e.data),r(),t()}})}(),$(".selectInput").change(function(){var e=$("#amchartContainer");$(".hideLoading").show(),$("aside").removeClass("aside-active"),e.children().length>1&&(e.fadeOut(300),setTimeout(function(){e.remove(),$("#sideList").children().remove()},300)),n();var o=m();setTimeout(function(){-1===o.indexOf("csv")?$.getJSON(o,function(e){p(e),r(),t()}):Papa.parse(o,{download:!0,header:!0,skipEmptyLines:!0,complete:function(e){console.log(e.data),p(e.data),r(),t()}})},525)}),String.prototype.toHHMMSS=function(){var t=parseInt(this,10),e=Math.floor(t/3600),o=Math.floor((t-3600*e)/60),p=t-3600*e-60*o;10>e&&(e="0"+e),10>o&&(o="0"+o),10>p&&(p="0"+p);var a=e+":"+o+":"+p;return a};var h=document.querySelector(".moreButton");h.addEventListener("click",a,!1),$(".postComments").submit(function(t){t.preventDefault();var e=$(".addComment").val(),o=$("#commentList");o.children().length>1&&o.children().remove();var p=c.child(s());p.push({comment:e})}),$(".toggleComments").click(function(){d.toggleClass("aside-active")}),$(document).keyup(function(t){if(27==t.keyCode){d.removeClass("aside-active"),$(".moreInfo").removeClass("showMoreInfo");var e=document.querySelector(".moreButton");"More"===$(".moreButton").text()?(e.innerHTML="Less",e.style.paddingLeft="19px"):(e.innerHTML="More",e.style.paddingLeft="16px")}}),$(document).scrollScope();var M=document.querySelector(".logoutButton");M.addEventListener("click",i,!1),$("#fileToUpload").change(function(){u.val().length>30?($(".uploadMessage > p").text("Sorry, file name must be less than 30 characeters"),l.addClass("uploadMessage-active").delay(5e3).queue(function(t){$(this).removeClass("uploadMessage-active"),t()})):(u.val($(this).val().split("\\").pop()),$(".confirmUpload").addClass("confirmUpload-active"))}),$(".uploadForm").submit(function(t){t.preventDefault();var e="/mrt/csvUploader.php",o=new FormData(this),p=$("#fileToUpload").val();fileExt=-1===p.indexOf("json")?".csv":".json";var a=p.split("\\").pop().split(".").shift();return $(".confirmUpload").removeClass("confirmUpload-active"),l.css("background-color","#D32F2F"),$.ajax({type:"POST",url:e,data:o,processData:!1,contentType:!1,success:function(t){if($(".uploadMessage > p").text(t),l.addClass("uploadMessage-active").delay(4800).queue(function(t){$(this).removeClass("uploadMessage-active"),t()}),t.indexOf("succesfully")>-1){$(".uploadMessage").css("background-color","#388E3C");var e=document.createElement("option");fileNameReplaced=a.replace(/_/g," "),e.innerHTML=fileNameReplaced,e.value="/mrt/inputdata/"+a+fileExt,$(".selectInput").prepend(e)}}}),!1})});